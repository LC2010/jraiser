/*!
 * jRaiser 2 Javascript Library
 * slideshow-pager - v1.0.0 (2013-05-02T09:43:10+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("slideshow/1.0.x/pager",["base/1.0.x/","dom/1.0.x/","widget/1.0.x/"],function(e,t,n){"use strict";var r=e("base/1.0.x/"),i=e("dom/1.0.x/"),s=e("widget/1.0.x/");return s.create(function(e){},{_init:function(e){var t=this,n=t._wrapper=e.wrapper,r=t._wrapper.children();t._itemSize=r.outerWidth(!0),t._total=r.length,t._totalItemSize=t._itemSize*t._total,t._itemNumberLimit=Math.floor(n.parent().innerWidth()/t._itemSize);if(!t._itemNumberLimit)return;var s=t._itemNumberLimit-1;s%2?(t._widerSideNumber=Math.ceil(s/2),t._narrowerSideNumber=Math.floor(s/2),t._narrowerSideNumber>1&&(t._widerSideNumber+=1,t._narrowerSideNumber-=1)):(t._widerSideNumber=t._narrowerSideNumber=parseInt(s/2),t._narrowerSideNumber>2?(t._widerSideNumber+=2,t._narrowerSideNumber-=2):t._narrowerSideNumber>1&&(t._widerSideNumber+=1,t._narrowerSideNumber-=1));var o=r.clone(),u=r.clone();n.css("width",3*t._totalItemSize).prepend(o),n.append(u).css("left",-t._totalItemSize),t._itemCopies=[o,r,u],t._selectHandler=function(e){e.type==="click"&&e.preventDefault(),t.select(i(this).index(),e)},t._items=t._wrapper.children().on(e.selectWhen,t._selectHandler)},_destroy:function(e){var t=this;delete t._itemSize,delete t._total,delete t._totalItemSize,delete t._itemNumberLimit,delete t._widerSideNumber,delete t._narrowerSideNumber,delete t._itemCopies,t._items.off(e.selectWhen,t._selectHandler),delete t._selectHandler,delete t._items},select:function(e,t){var n=this;n._triggerIndex=e,n.trigger("select",r.mix({newIndex:e%n._total,oldIndex:n._current},t,{overwrite:!1}))},activate:function(e){var t=this,n=e.newIndex;if(t._current==n)return;t._items.forEach(function(e,r){r%t._total===n?i(e).addClass(t._options.currentItemClass):i(e).removeClass(t._options.currentItemClass)}),t._current!=null&&(t._scrollTo(t._triggerIndex,e.newIndex),delete t._triggerIndex),t._current=n},next:function(e){this._scroll(e,1)},prev:function(e){this._scroll(e,0)},_scrollTo:function(e,t){var n=this,r=Math.abs(parseInt(n._wrapper.css("left"))),i=r/n._itemSize,s=i+n._itemNumberLimit-1,o,u,a,f;for(a=0;a<3;a++){f=n._current+n._total*a;if(f>=i&&f<=s){u=!0;break}}if(!u)return;if(e==null){for(a=0;a<3;a++){f=t+n._total*a;if(f>=i&&f<=s){e=f;break}}o=parseInt((n._itemNumberLimit-1)/2)}i==e?e-=o!=null?n._itemNumberLimit-1-o:n._widerSideNumber:s==e?e-=o||n._narrowerSideNumber:e=null,e!=null&&n._doScrolling(-e*n._itemSize)},_scroll:function(e,t){this._doScrolling(parseInt(this._wrapper.css("left"))+this._itemSize*(t?-e:e))},_doScrolling:function(e){var t=this;if(t._moving)return;var n=t._wrapper,i=parseInt(n.css("left"));e>-t._totalItemSize?(n.css("left",i-t._totalItemSize).prepend(t._itemCopies[2]),e-=t._totalItemSize,t._itemCopies.unshift(t._itemCopies.pop())):e<-(t._totalItemSize*2-t._itemSize*t._itemNumberLimit)&&(n.css("left",i+t._totalItemSize).append(t._itemCopies[0]),e+=t._totalItemSize,t._itemCopies.push(t._itemCopies.shift())),t._moving=!0,n.animate({left:e},r.mix({callback:function(){delete t._moving}},t._options.animation,{overwrite:!1}))}},{selectWhen:"click",currentItemClass:"slideshow-nav-current"})})