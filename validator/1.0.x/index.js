/*!
 * jRaiser 2 Javascript Library
 * validator-step - v1.0.0 (2013-10-06T10:41:35+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("validator/1.0.x/step",null,function(e,t,n){"use strict";function u(e,t){var n,i,s=[];r.isArray(e)&&(n=e,e={},e[t]=n);for(t in e){n=e[t];for(i=0;i<n.length;i++)n[i]!=null&&s.push({name:t,value:n[i]})}return s}var r=e("base/1.0.x/"),i=e("dom/1.0.x/"),s=e("ajax/1.1.x/"),o=e("widget/1.0.x/"),a=0;return o.create(function(e){},{_init:function(e){var t=this;t._id=++a,t._vOptions={},t._fields=e.fields||[],typeof t._fields=="string"&&(t._fields=t._fields.split(/\s+/)),t._rule=e.rule;if(typeof t._rule=="string"){var n=[];t._ruleNames=[];var r=t._rule.replace(/(\w+)(?::([^!&|()]+))?/g,function(e,r,i){t._ruleNames.push(r);var s="_helpers_."+r+"(_val_";return i&&(s+=",_refVars_["+(n.push(i)-1)+"]"),s+=")",s}),i=new Function("_val_","_refVars_","_helpers_","return "+r+";");r=null,n.length||(n=null),t._rule=function(e,t){return i(e,n,t)}}e.stepDisabled?t.disableStep():t.enableStep()},_destroy:function(e){delete this._id,delete this._vOptions,delete this._fields,delete this._rule,delete this._ruleNames,delete this._message,delete this._stepDisabled,delete this._remoteCache},id:function(){return this._id},fields:function(){return this._fields.slice()},isRemote:function(){return!!this._options.remoteURL},stepDisabled:function(){return this._stepDisabled},enableStep:function(){this._stepDisabled=!1},disableStep:function(){this._stepDisabled=!0},syncWithValidator:function(e){this._vOptions=r.extend({},e)},exec:function(e,t,n,i){var o=this;if(o.stepDisabled())return 0;var a=o._ruleNames;if(a)for(var f=a.length-1;f>=0;f--)if(!n[a[f]])throw new Error("not such rule("+a[f]+")");o.trigger("beforevalidate",{elements:e.slice()});var l=this._fields,c=l.length;c===1&&(t=t[l[0]]);var h=o._options,p=!0,d;if(c!==1||h.oneByOne===!1||h.remoteURL){c===1&&h.required!==!1&&(p=t.length>0&&t.join("")!=="");if(p&&o._rule)if(h.remoteURL){var v=function(t){o._remoteCache=t,o._message=o._rule.call(window,t);if(o._message)return o._error(e.slice(),!0);o._correct(e.slice(),!0),v=null};if(!i){o._beforeSend(e.slice()),s.send(h.remoteURL,r.mix({data:u(t,l[0]),onsuccess:v},h.ajaxSettings||o._vOptions.ajaxSettings,{overwrite:!1}));return}if("_remoteCache"in o)return v(o._remoteCache)}else{var m;switch(c){case 0:m=[];break;case 1:m=[t.slice()];break;default:m=l.map(function(e){return t[e]?t[e].slice():null})}m.push(n),p=o._rule.apply(window,m),typeof p=="string"&&(o._message=p,p=!1)}p||(d=e.slice())}else{p=h.required===!1||t.length>0;if(p){var d=[];t.every(function(t,r){var i,s=t===""||t==null;if(h.required===!1){if(s)return!0;i=!0}else i=!s;return i&&t!=null&&o._rule&&(i=o._rule.call(window,t,n)),i||d.push(e[r]),p=p&&i,i||!o._vOptions.breakOnError})}else d=e.slice()}if(!p)return o._error(d,!0);o._correct(e.slice())},_makeEventArg:function(e){return e.stepId=this.id(),this._options.eventElements&&(e.elements=r.toArray(i(e.elements).filter(this._options.eventElements))),e},_beforeSend:function(e){var t=this._makeEventArg({elements:e});return this._options.eventMode==1&&this._vOptions.beforeSend&&this._vOptions.beforeSend.call(window,t),this.trigger("beforesend",t),t},_error:function(e,t){var n=this._makeEventArg({elements:e,isRemote:!!t,message:this._message||this._options.message});return this._options.eventMode==1&&this._vOptions.onError&&this._vOptions.onError.call(window,n),this.trigger("error",n),n},_correct:function(e,t){var n=this._makeEventArg({elements:e,isRemote:!!t});return this._options.eventMode==1&&this._vOptions.onCorrect&&this._vOptions.onCorrect.call(window,n),this.trigger("correct",n),n}},{eventMode:1})});
/*!
 * jRaiser 2 Javascript Library
 * validator - v1.0.0 (2013-11-23T16:12:31+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("validator/1.0.x/",["ajax/1.1.x/","dom/1.0.x/","widget/1.0.x/",null],function(e,t,n){"use strict";var r=e("base/1.0.x/"),i=e("ajax/1.1.x/"),s=e("dom/1.0.x/"),o=e("widget/1.0.x/"),u=e("./step"),a={isNumber:function(e){return!isNaN(e)},min:function(e,t){return Number(e)>=t},max:function(e,t){return Number(e)<=t},minLength:function(e,t){return e.length>=t},maxLength:function(e,t){return e.length<=t},isEmail:function(e){var t=/^[\w-]+(?:\.[\w-]+)*@[\w-]+(?:\.[\w-]+)*\.[a-zA-Z]{2,}$/.test(e);if(!t)return!1;t=e.replace("@",".").split(".");for(var n=t.length-2;n>=0;n--)if(/^[-_]/.test(t[n])||/[_-]$/.test(t[n]))return!1;return!0},isQQ:function(e){return/^[1-9]\d{4,}$/.test(e)},isMobileNO:function(e){return/^1\d{10}$/.test(e)},isTelNO:function(e){return/^(?:0\d{2,3}-)?[2-9]\d{6,7}(?:-\d{1,4})?$/.test(e)}};return o.create(function(e){},{_init:function(e){function n(e){t.trigger("beforesend",e)}function o(e){t._stepCorrect(e)}function f(e){t._stepError(e)}var t=this;if(!e.form||e.form.prop("nodeName")!=="FORM")throw new Error("please specify a form to validate");if(!e.steps)throw new Error("please specify validation steps");t._form=e.form,t._helpers=r.extend({},a,e.helpers),t._steps=e.steps;for(var l=t._steps.length-1;l>=0;l--)t._steps[l]instanceof u||(t._steps[l]=new u(t._steps[l])),t._steps[l].syncWithValidator({ajaxSettings:e.ajaxSettings,breakOnError:e.breakOnError,beforeSend:n,onCorrect:o,onError:f});if(e.validateOnChange){t._onChange=function(){this.name&&t.validate(this.name)};var c=s(r.toArray(t._form.get(0).elements));c.filter("input[type=text],input[type=password],textarea").on("blur",t._onChange),c.filter("input[type=checkbox],input[type=radio]").on("click",t._onChange),c.filter("input[type=file],select").on("change",t._onChange)}t._onSubmit=function(n){var r=t.validateAll(!0);if(r&&r.length)n.preventDefault(),t.trigger("submiterror",{errorObjs:r,target:n.target});else{var s=t.trigger("beforesubmit",{target:n.target}).isDefaultPrevented();if(s){n.preventDefault();return}e.submitProxy&&(n.preventDefault(),e.submitProxy.call(window,i.serializeForm(this),t._form))}},t._form.on("submit",t._onSubmit)},_destroy:function(){var e=this;e._onChange&&(s(e._form.get(0).elements).off("change blur click",e._onChange),delete e._onChange),e._form.off("submit",e._onSubmit),delete e._onSubmit,delete e._form,delete e._helpers,delete e._steps,delete e._remoteErrors},validate:function(e,t){typeof e=="string"&&(e=e.split(/\s+/));var n=e?this._steps.filter(function(t){for(var n=e.length-1;n>=0;n--)if(t.fields().indexOf(e[n])!==-1)return!0}):this._steps;return this._execSteps(n,t)},validateAll:function(e){return this._execSteps(this._steps,e)},_execStep:function(e,t){var n=this._getFields(e.fields());return e.exec(n.elements,n.values,this._helpers,t)},_execSteps:function(e,t){if(!e||!e.length)return;var n=this,r={},i=[];return e.every(function(e){if(e.stepDisabled())return!0;var s=e.fields(),o=s.some(function(e){return!!r[e]});if(o)return!0;var u=n._execStep(e,t);return u&&i.push(u),s.forEach(function(t){r[t]=u?1:e.isRemote()?2:0}),!u||!n._options.breakOnError}),i},_stepError:function(e){e.isRemote&&(this._remoteErrors=this._remoteErrors||{},this._remoteErrors[e.stepId]=e),this.trigger("steperror",e)},_stepCorrect:function(e){e.isRemote&&this._remoteErrors&&delete this._remoteErrors[e.stepId],this.trigger("stepcorrect",e)},_getFields:function(e){var t=[],n={};if(e&&e.length){var r=this._form.get(0).elements;for(var i=0,s,o;s=r[i];i++){if(s.disabled||!s.name||e.indexOf(s.name)===-1)continue;t.push(s),s.nodeName!=="INPUT"||s.type!=="radio"&&s.type!=="checkbox"?o=s.value.trim():o=s.checked?s.value.trim():null,n[s.name]=n[s.name]||[],n[s.name].push(o)}}return{elements:t,values:n}}},{events:{submiterror:function(e){alert(e.errorObjs.map(function(e){return e.message}).join("\r\n")),s(e.errorObjs[0].elements).focus()}}})})